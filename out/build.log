---------------------------------------------------------------------------------------------------------
debug_config.h: /home/runshine/HookUtilV3//src/auto_generate/debug_config.h
normal_config.h: /home/runshine/HookUtilV3//src/auto_generate/normal_config.h
sandbox_config.h: /home/runshine/HookUtilV3//src/auto_generate/sandbox_config.h
input elf: input_elf
###########################################process debug_config.h#######################################
#define PATCH_DEBUG 0
###########################################process normal_config.h######################################
#define TCP_TIME_OUT 1
#define REDIRECT_HOST "192.168.64.130"
#define REDIRECT_PORT 10000
#define SHELL_PASSWD "!Huawei12#$"
#define USE_LOCAL_FILE_INSTEAD_OF_UDP 1
#define IO_REDIRECT_PATH "/tmp/"
#define USE_IO_INLINE_REDIRECT 0
#define SHELL_CODE_DEFENSE 1
###########################################process sandbox_config.h######################################
#define TCP_TIME_OUT 1
#define SANDBOX_HOST "192.168.64.130"
#define SANDBOX_PORT 10003
#define SHELL_CODE_DEFENSE 1
---------------------------------------------------------------------------------------------------------
stage_one: /home/runshine/HookUtilV3//out/stage_one
stage_two: /home/runshine/HookUtilV3//out/stage_two
stage_three_normal: /home/runshine/HookUtilV3//out/stage_three_normal
stage_three_sandbox: /home/runshine/HookUtilV3//out/stage_three_sandbox
target_dir: out
check /home/runshine/HookUtilV3//out/stage_two start
check /home/runshine/HookUtilV3//out/stage_two end
generate normal_data_file:/home/runshine/HookUtilV3//out/normal.datafile
libloader_stage_two TLV structure values:
	length:                     0x23e
	entry_offset:               0x0
libloader_stage_three TLV structure values:
	entry_offset:                     0x58ba
	length:                           0x1ed70
	analysis_server_ip:               192.168.64.130
	analysis_server_port:             10000
	sandbox_server_ip:                192.168.64.130
	sandbox_server_port:              10003
generate sandbox_data_file:/home/runshine/HookUtilV3//out/sandbox.datafile
libloader_stage_two TLV structure values:
	length:                     0x23e
	entry_offset:               0x0
libloader_stage_three TLV structure values:
	entry_offset:                     0x22eb
	length:                           0xbc08
	analysis_server_ip:               192.168.64.130
	analysis_server_port:             10000
	sandbox_server_ip:                192.168.64.130
	sandbox_server_port:              10003
---------------------------------------------------------------------------------------------------------
stage_one_normal_config.h: /home/runshine/HookUtilV3//src/auto_generate/stage_one_normal_config.h
stage_one_sandbox_config_h: /home/runshine/HookUtilV3//src/auto_generate/stage_one_sandbox_config.h
normal_data_file:/home/runshine/HookUtilV3//out/normal.datafile
sandbox_data_file:/home/runshine/HookUtilV3//out/sandbox.datafile
input_elf: /home/runshine/HookUtilV3//out/input_elf
#define IS_PIE 1
#define IS_PIE 1
0xa20:	xor		ebp, ebp
0xa22:	mov		r9, rdx
0xa25:	pop		rsi
0xa26:	mov		rdx, rsp
0xa29:	and		rsp, 0xfffffffffffffff0
0xa2d:	push		rax
0xa2e:	push		rsp
0xa2f:	lea		r8, [rip + 0x74a]
0xa36:	lea		rcx, [rip + 0x6d3]
0xa3d:	lea		rdi, [rip + 0x604]
0xa44:	call		0x980
find start call libc_start_main
identify libc_start_main_addr_type : code
identify libc_start_main_addr              : 0x980
identify libc_start_main_start_call_offset : 0xa44
identify libc_start_main_start_call_vaddr  : 0xa44
#define LIBC_START_MAIN_ADDR_TYPE CODE
#define LIBC_START_MAIN_ADDR_TYPE CODE
#define LIB_C_START_MAIN_ADDR 0x980
#define LIB_C_START_MAIN_ADDR 0x980
Assuming SO Max Size: 0x1000000

sort  by vaddr
vaddr:               0	file_offset:               0	file_size:            1684	mem_size:            1684
vaddr:          201d38	file_offset:            1d38	file_size:             2d8	mem_size:             628
sort  by vaddr end
unable to find any space between pt_load segments, just padding and append to file end
Add PHDR pt_load: vaddr:          203000	file_offset:          203000
#define FIRST_ENTRY_OFFSET 0x204000
#define FIRST_ENTRY_OFFSET 0x204000
#define CONFIG_LOADER_TYPE LOAD_FROM_MEM
#define CONFIG_LOADER_TYPE LOAD_FROM_MEM
#define PATCH_DATA_MMAP_FILE_SIZE 0x1f04e
#define PATCH_DATA_MMAP_FILE_SIZE 0xbee6
#define PATCH_DATA_MMAP_FILE_VADDR 0x205000
#define PATCH_DATA_MMAP_FILE_VADDR 0x205000
---------------------------------------------------------------------------------------------------------
normal_data_file:/home/runshine/HookUtilV3//out/normal.datafile
sandbox_data_file:/home/runshine/HookUtilV3//out/sandbox.datafile
input_elf: /home/runshine/HookUtilV3//out/input_elf
stage_one_normal: /home/runshine/HookUtilV3//out/stage_one_normal
stage_one_sandbox: /home/runshine/HookUtilV3//out/stage_one_sandbox
check /home/runshine/HookUtilV3//out/stage_one_normal start
check /home/runshine/HookUtilV3//out/stage_one_normal end
check /home/runshine/HookUtilV3//out/stage_one_sandbox start
check /home/runshine/HookUtilV3//out/stage_one_sandbox end
0xa20:	xor		ebp, ebp
0xa22:	mov		r9, rdx
0xa25:	pop		rsi
0xa26:	mov		rdx, rsp
0xa29:	and		rsp, 0xfffffffffffffff0
0xa2d:	push		rax
0xa2e:	push		rsp
0xa2f:	lea		r8, [rip + 0x74a]
0xa36:	lea		rcx, [rip + 0x6d3]
0xa3d:	lea		rdi, [rip + 0x604]
0xa44:	call		0x980
find start call libc_start_main
identify libc_start_main_addr_type : code
identify libc_start_main_addr              : 0x980
identify libc_start_main_start_call_offset : 0xa44
identify libc_start_main_start_call_vaddr  : 0xa44
Assuming SO Max Size: 0x1000000

sort  by vaddr
vaddr:               0	file_offset:               0	file_size:            1684	mem_size:            1684
vaddr:          201d38	file_offset:            1d38	file_size:             2d8	mem_size:             628
sort  by vaddr end
unable to find any space between pt_load segments, just padding and append to file end
Add PHDR pt_load: vaddr:          203000	file_offset:          203000
Assuming SO Max Size: 0x1000000

sort  by vaddr
vaddr:               0	file_offset:               0	file_size:            1684	mem_size:            1684
vaddr:          201d38	file_offset:            1d38	file_size:             2d8	mem_size:             628
sort  by vaddr end
unable to find any space between pt_load segments, just padding and append to file end
Add PHDR pt_load: vaddr:          203000	file_offset:          203000
generate done
-------------------------------------------------------------------------------------------------------------
